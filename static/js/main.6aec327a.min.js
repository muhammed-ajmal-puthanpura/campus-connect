document.addEventListener('DOMContentLoaded',function(){const alerts=document.querySelectorAll('.alert');alerts.forEach(alert=>{setTimeout(()=>{alert.style.opacity='0';setTimeout(()=>alert.remove(),300);},5000);});});function validateForm(formId){const form=document.getElementById(formId);if(!form)return true;const inputs=form.querySelectorAll('input[required], select[required], textarea[required]');let isValid=true;inputs.forEach(input=>{if(!input.value.trim()){input.style.borderColor='var(--danger-color)';isValid=false;}else{input.style.borderColor='var(--border-color)';}});return isValid;}
function confirmAction(message){if(message&&typeof message==='string'&&message.trim()==='')message=undefined;if(arguments.length>1&&typeof arguments[0]==='object'&&arguments[0].tagName){var form=arguments[0];var msg=arguments[1]||'Are you sure you want to perform this action?';if(window.customConfirm){window.customConfirm(msg).then(function(yes){if(yes)form.submit();});return false;}
return confirm(msg);}
return confirm(message||'Are you sure you want to perform this action?');}
function validateEventDate(){const dateInput=document.querySelector('input[name="date"][type="date"]');if(dateInput){dateInput.addEventListener('change',function(){const selectedDate=new Date(this.value);const today=new Date();today.setHours(0,0,0,0);if(selectedDate<today){if(window.customAlert){window.customAlert('Event date cannot be in the past');}else{alert('Event date cannot be in the past');}
this.value='';}});}}
function validateEventTime(){const startTime=document.querySelector('input[name="start_time"]');const endTime=document.querySelector('input[name="end_time"]');if(startTime&&endTime){endTime.addEventListener('change',function(){if(startTime.value&&endTime.value){if(endTime.value<=startTime.value){if(window.customAlert){window.customAlert('End time must be after start time');}else{alert('End time must be after start time');}
this.value='';}}});}}
document.addEventListener('DOMContentLoaded',function(){validateEventDate();validateEventTime();});function scrollToTop(){window.scrollTo({top:0,behavior:'smooth'});}
function printCertificate(){window.print();}
function copyToClipboard(text){navigator.clipboard.writeText(text).then(()=>{if(window.customAlert){window.customAlert('Copied to clipboard!');}else{alert('Copied to clipboard!');}}).catch(err=>{console.error('Failed to copy:',err);});}
function toggleMobileMenu(){const navMenu=document.querySelector('.nav-menu');if(navMenu){navMenu.classList.toggle('active');}}
function filterTable(inputId,tableId){const input=document.getElementById(inputId);const table=document.getElementById(tableId);if(!input||!table)return;input.addEventListener('keyup',function(){const filter=this.value.toLowerCase();const rows=table.querySelectorAll('tbody tr');rows.forEach(row=>{const text=row.textContent.toLowerCase();row.style.display=text.includes(filter)?'':'none';});});}
function exportTableToCSV(tableId,filename){const table=document.getElementById(tableId);if(!table)return;let csv=[];const rows=table.querySelectorAll('tr');rows.forEach(row=>{const cols=row.querySelectorAll('td, th');const rowData=Array.from(cols).map(col=>col.textContent.trim());csv.push(rowData.join(','));});const csvContent=csv.join('\n');const blob=new Blob([csvContent],{type:'text/csv'});const url=window.URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=filename||'export.csv';a.click();}
function showLoading(){const spinner=document.createElement('div');spinner.id='loading-spinner';spinner.innerHTML='<div class="spinner"></div>';document.body.appendChild(spinner);}
function hideLoading(){const spinner=document.getElementById('loading-spinner');if(spinner)spinner.remove();}
function debounce(func,wait){let timeout;return function executedFunction(...args){const later=()=>{clearTimeout(timeout);func(...args);};clearTimeout(timeout);timeout=setTimeout(later,wait);};}
function initTooltips(){const tooltips=document.querySelectorAll('[data-tooltip]');tooltips.forEach(element=>{element.addEventListener('mouseenter',function(){const tooltip=document.createElement('div');tooltip.className='tooltip';tooltip.textContent=this.dataset.tooltip;document.body.appendChild(tooltip);const rect=this.getBoundingClientRect();tooltip.style.top=rect.top-tooltip.offsetHeight-5+'px';tooltip.style.left=rect.left+(rect.width-tooltip.offsetWidth)/2+'px';});element.addEventListener('mouseleave',function(){const tooltip=document.querySelector('.tooltip');if(tooltip)tooltip.remove();});});}
function checkPasswordStrength(password){let strength=0;if(password.length>=8)strength++;if(password.match(/[a-z]+/))strength++;if(password.match(/[A-Z]+/))strength++;if(password.match(/[0-9]+/))strength++;if(password.match(/[$@#&!]+/))strength++;return strength;}
function displayPasswordStrength(){const passwordInput=document.querySelector('input[type="password"]');if(!passwordInput)return;const strengthMeter=document.createElement('div');strengthMeter.className='password-strength';passwordInput.parentNode.appendChild(strengthMeter);passwordInput.addEventListener('input',function(){const strength=checkPasswordStrength(this.value);const labels=['Very Weak','Weak','Fair','Good','Strong'];const colors=['#ef4444','#f59e0b','#eab308','#10b981','#059669'];strengthMeter.textContent=labels[strength-1]||'';strengthMeter.style.color=colors[strength-1]||'';});}
document.addEventListener('DOMContentLoaded',function(){initTooltips();});document.addEventListener('click',function(e){const target=e.target;if(target&&target.classList.contains('read-more')){e.preventDefault();const container=target.closest('.event-description');if(!container)return;const shortEl=container.querySelector('.desc-short');const fullEl=container.querySelector('.desc-full');if(!shortEl||!fullEl)return;const fullDisplay=window.getComputedStyle(fullEl).display;if(fullDisplay==='none'){shortEl.style.display='none';fullEl.style.display='';target.textContent='Read less';}else{shortEl.style.display='';fullEl.style.display='none';target.textContent='Read more';}}});document.addEventListener('DOMContentLoaded',function(){const modeSelect=document.getElementById('event-mode');const venueSelect=document.getElementById('venue-select');const meetingUrl=document.getElementById('meeting-url');function updateMode(){const val=(modeSelect&&modeSelect.value)?modeSelect.value.toLowerCase():'offline';if(val==='online'){if(venueSelect)venueSelect.style.display='none';if(meetingUrl)meetingUrl.style.display='';}else{if(venueSelect)venueSelect.style.display='';if(meetingUrl)meetingUrl.style.display='none';}}
if(modeSelect){modeSelect.addEventListener('change',updateMode);updateMode();}});function updateVenueOptions(){const deptSelect=document.getElementById('dept-select');const venueSelectInput=document.getElementById('venue-select-input');if(!deptSelect||!venueSelectInput)return;const selectedDept=deptSelect.value;let anyVisible=false;Array.from(venueSelectInput.options).forEach(opt=>{if(!opt.dataset||typeof opt.dataset.dept==='undefined')return;const optDept=opt.dataset.dept;if(optDept==='common'||(selectedDept&&optDept===selectedDept)){opt.style.display='';anyVisible=true;}else{opt.style.display='none';if(venueSelectInput.value===opt.value)venueSelectInput.value='';}});if(!selectedDept){Array.from(venueSelectInput.options).forEach(opt=>opt.style.display='');anyVisible=true;}
const modeSelect=document.getElementById('event-mode');const mode=modeSelect?modeSelect.value.toLowerCase():'offline';if(mode==='offline'&&anyVisible){venueSelectInput.setAttribute('required','required');}else{venueSelectInput.removeAttribute('required');}}
document.addEventListener('DOMContentLoaded',function(){const deptSelect=document.getElementById('dept-select');if(deptSelect){deptSelect.addEventListener('change',updateVenueOptions);updateVenueOptions();}
const modeSelect2=document.getElementById('event-mode');if(modeSelect2)modeSelect2.addEventListener('change',updateVenueOptions);});function formatDate(dateString){const date=new Date(dateString);return date.toLocaleDateString('en-US',{year:'numeric',month:'long',day:'numeric'});}
function formatTime(timeString){const[hours,minutes]=timeString.split(':');const hour=parseInt(hours);const ampm=hour>=12?'PM':'AM';const displayHour=hour%12||12;return`${displayHour}:${minutes} ${ampm}`;}
(function(){var modal,titleEl,bodyEl,okBtn,cancelBtn;function initModal(){modal=document.getElementById('custom-modal');if(!modal)return;titleEl=document.getElementById('custom-modal-title');bodyEl=document.getElementById('custom-modal-body');okBtn=document.getElementById('custom-modal-ok');cancelBtn=document.getElementById('custom-modal-cancel');window.closeCustomModal=function(){modal.classList.remove('show');modal.setAttribute('aria-hidden','true');};window.customAlert=function(message,title){return new Promise(function(resolve){titleEl.textContent=title||'Notice';bodyEl.textContent=message||'';cancelBtn.style.display='none';okBtn.textContent='OK';modal.classList.add('show');modal.setAttribute('aria-hidden','false');okBtn.focus();function cleanup(){okBtn.removeEventListener('click',onOk);}
function onOk(){cleanup();window.closeCustomModal();resolve();}
okBtn.addEventListener('click',onOk);});};window.customConfirm=function(message,title){return new Promise(function(resolve){titleEl.textContent=title||'Confirm';bodyEl.textContent=message||'';cancelBtn.style.display='';okBtn.textContent='Yes';modal.classList.add('show');modal.setAttribute('aria-hidden','false');okBtn.focus();function cleanup(){okBtn.removeEventListener('click',onOk);cancelBtn.removeEventListener('click',onCancel);}
function onOk(){cleanup();window.closeCustomModal();resolve(true);}
function onCancel(){cleanup();window.closeCustomModal();resolve(false);}
okBtn.addEventListener('click',onOk);cancelBtn.addEventListener('click',onCancel);});};}
if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',initModal);}else{initModal();}})();(function(){function handleToasts(){try{var key='dashboard_notifications_shown';var toasts=document.querySelectorAll('.dashboard-toast');if(!toasts||toasts.length===0)return;if(!sessionStorage.getItem(key)){setTimeout(function(){toasts.forEach(function(el){el.style.display='none';});try{sessionStorage.setItem(key,'1');}catch(e){}},5000);}else{toasts.forEach(function(el){el.style.display='none';});}}catch(e){console.error('Toast handler error',e);}}
if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',handleToasts);}else{handleToasts();}})();